<!DOCTYPE html>
<html lang="en">
    <head>
    <title>GigaExchange</title>
    <script src = "https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>GigaExchange</title>
	<link rel="shortcut icon" href="img/favicon.ico">
	<!-- Bootstrap 4.5 CSS -->
	<link rel="stylesheet" href="{{ url_for('static', filename= 'css/bootstrap.min.css') }}">
	<!-- Style CSS -->
	<link rel="stylesheet" href="{{ url_for('static', filename= 'css/style.css') }}">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700&display=swap" rel="stylesheet">
</head>
<body>

	<!-- Top Bar -->
	<div class="top-bar">
		<div class="container">
			<div class="col-12 text-right">
				<p>Welcome to GigaExchange!</p>
			</div>
		</div>
	</div>

	<!-- End Top Bar -->


	<!-- Navigation -->
	<nav class = "navbar bg-light navbar-light navbar-expand-lg">
		<div class="container">

			<a href="{{ url_for('Home')}}" class="navbar-brand"><img src="{{url_for('static', filename='logo.jpg')}}" alt="Logo" title = "GigaExchange"></a>

			<button class="navbar-toggler" type = "button" data-toggle = "collapse" data-target = "#navbarResponsive">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class = "collapse navbar-collapse" id = "navbarResponsive">
				<ul class = "navbar-nav ml-auto">
					<li class = "nav-item active"><a href = "{{ url_for('Home')}}" class = "nav-link">Home</a></li>
					<li class = "nav-item"><a href = "{{ url_for('About')}}" class = "nav-link">About</a></li>
					<li class = "nav-item"><a href = "{{ url_for('Info')}}" class = "nav-link">Info</a></li>
					<li class = "nav-item"><a href = "{{ url_for('ContactUs')}}" class = "nav-link">Contact Us</a></li>
					<li class = "nav-item"><a href = "{{ url_for('LogIn')}}" class = "nav-link">Log-In</a></li>
                    <li class = "nav-item"><a href = "{{ url_for('GigaExchange')}}" class = "nav-link">GigaExchange</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- End Navigation -->

    <div id = "chart"></div>

    <div id = "trades"></div>

    <div style = "border: solid gray 1px; padding: 20px; width: 600px; margin-top: 20px;">
        <h3>Buy Crypto</h3>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
            <div style= "padding: 10px; margin-bottom: 10px; background: pink; border: solid red 1px; color: red;"></div>
    
                {% for message in messages %}
                    {{ message }}
                    {% endfor %}
            </div>

            {% endif %}
        {% endwith %}

        <form action = "/buy" method = "post">
            <input type = "text" id = "quantity" name = "quantity" placeholder = "eg. 0.001" />
            <select id = "symbol" name = "symbol">
                {% for symbol in symbols %}
                    <option> {{ symbol['symbol'] }}</option>
                {% endfor %}
            </select>
            <input type = "submit" name = "buy" value = "buy" />
        </form>
    </div>
    <div style = "border: solid gray 1px; padding: 20px; width: 600px; margin-top: 20px;">
    <h3>Sell Crypto</h3>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
            <div style= "padding: 10px; margin-bottom: 10px; background: pink; border: solid red 1px; color: red;"></div>
    
                {% for message in messages %}
                    {{ message }}
                    {% endfor %}
            </div>

            {% endif %}
        {% endwith %}
    <form action = "/sell" method = "post">
        <input type = "text" id = "quantity" name = "quantity" placeholder = "eg. 0.001" />
        <select id = "symbol" name = "symbol">
            {% for symbol in symbols %}
                <option> {{ symbol['symbol'] }}</option>
            {% endfor %}
        </select>
        <input type = "submit" name = "sell" value = "sell" />
    </form>
</div>
    <div id = "balances"></div>
    <h2>Balances</h2>
    <table>
        {% for balance in my_balances %}
        <tr>
            <td>
                {{ balance ['asset'] }} 
            </td>
            <td>
                {{ balance ['free']}}
            </td>
        </tr>
        
          {% endfor %}
    </table>
    </div>
     <script>
        //var binanceSocket = new WebSocket ("wss://stream.binance.com:9443/ws/btcusdt@trade");
        
        var tradeDiv = document.getElementById('trades')
       //binanceSocket.onmessage = function (event){
            //console.log(event.data)

          // var messageObject = JSON.parse(event.data)

         //tradeDiv.append(messageObject.a)
     // }
        </script>
        <script src= "{{ url_for('static', filename='chart.js') }}"></script>
    </body>
</html>